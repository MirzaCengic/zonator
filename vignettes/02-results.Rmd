<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Create zonator project based on existing data}
-->

```{r setup, echo=FALSE}
options(width=160)
```

## Exploring results

First, let's set up the scene.

```{r setup-objects, message=FALSE}
library(zonator)

# Start by creating a project using the tutorial data
setup.dir <- system.file("extdata/tutorial/basic", package="zonator") 
tutorial.project <- create_zproject(setup.dir)

# Get a specific variant
variant.caz <- get_variant(tutorial.project, "01_core_area_zonation")

# Let's also rename the features and groups while we're at it
featurenames(variant.caz) <- c("Koala", "Masked.owl", "Powerful.owl", 
                             "Tiger.quoll", "Sooty.owl", "Squirrel.glider",
                             "Yellow-bellied.glider")
labels <- c("mammals", "owls")
names(labels) <- c(1, 2)
groupnames(variant.caz) <- labels
```

Each variant can either already have results (i.e. Zonation run has completed) 
or then not. This can be determined by using method `has_results()`.

```{r has-results, message=FALSE}
has_results(variant.caz)
```

Value `TRUE` indicates that Zonation has already been run and results are 
available and `FALSE` indicates that results are not available. For the tutorial
data used here, all the results are available.

Results of a given variant can be extracted using `results()`.

```{r get-results}
results.caz <- results(variant.caz)
```

### Working with performance results (curves)

Raw curves data (with or without groups) can be extracted from results using 
`curves()`. Optional argument `groups` defines whether feature or group specific
curves are returned. If you don't need every feature or aggregate statistic,
you can also get the data for particular features.


```{r curves}
# Get feature-specific curves
feature.curves <- curves(results.caz)
head(feature.curves)

# Get just 2 species
duo.curves <- curves(results.caz, cols=c("Koala", "Tiger.quoll"))
head(duo.curves)
```

Columns are exaclty the same as in Zonation curves output file. Note also that 
the actual feature columns are named according to feature names in the 
`Zvariant` object these results were derived from. Thus whatever names you 
assigned to features prior to extracting the results will be also seen here.

Let's see  what the group curves data looks like as a whole or for individual 
groups:

```{r grp-curves}
# Get group-specific curves
feature.grp.curves <- curves(results.caz, groups=TRUE)
head(feature.grp.curves)

# Get all the aggregate stats for owls
owls.grp.curves <- curves(results.caz, groups=TRUE, 
                          cols=c("min.owls", "mean.owls", "max.owls",
                                 "w.mean.owls", "ext2.owls"))
head(owls.grp.curves)
```



### Plotting performance curves

Performance data (curves) can also be easily plotted, feature- or group-wise.

```{r curves-plotting, fig.width=10}
plot(feature.curves, invert.x=TRUE, main="All features")
plot(duo.curves, invert.x=TRUE, main="Just few features")
```